SELECT DISTINCT SYS_SBB AS "SYS", PRIN_SBB AS "PRIN", NODE_HSL AS "NODE", HSE_KEY_SBB AS "HSE_KEY", CUST_ACCT_NO_SBB AS "CUST_ACCT_NO", SUB_ACCT_NO_SBB AS "ACCOUNT",
RES_NAME_SBB AS "RES_NAME", EQP.EQP_MODEL_EQP AS "HOST_MODEL", EQP.BOX_STAT_EQP AS "EQUIP_STAT", DG.EQP_ADDR_EQP AS "CM_MAC",
CC.EQP_ADDR_EQP AS "RF_MAC", EQP.EQP_SERIAL_EQP AS "DAC_SERIAL", HEAD_END_CDE_HSL AS "HEADEND"  , EQP.SHIP_DTE_EQP AS "SHIP_DATE", EQP.EQP_CMPNT_EQP --EQP.ADDR_MODE_EQP--, descr_ccd as COMP_DESCR
FROM OPS$TWC.EQP_BASE EQP
JOIN OPS$TWC.SBB_BASE ON EQP_LOCAL_EQP = SUB_ACCT_NO_SBB
JOIN OPS$TWC.HSL_LOB ON HSE_KEY_HSL = HSE_KEY_SBB
               AND DELIVERY_SEGMENT_ID_HSL = 'C'
               AND CONNECT_CDE_HSL = 'A'
JOIN OPS$TWC.EQP_BASE DG ON DG.EQP_CMPNT_EQP = 'DG'
               AND EQP.EQP_SERIAL_EQP = DG.EQP_SERIAL_EQP
LEFT JOIN OPS$TWC.EQP_BASE CC ON CC.EQP_CMPNT_EQP = 'CC'
               AND EQP.EQP_SERIAL_EQP = CC.EQP_SERIAL_EQP
--LEFT JOIN OPS$TWC.CCD_CMPNT_DEFINITION ON CC.SYS_EQP = SYS_CCD
--            AND CC.PRIN_EQP = PRIN_CCD
WHERE --EQP.EQP_CMPNT_EQP IN ('DG')
 NODE_HSL IN ('*NODEVARIABLE*')